<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Somos Aventurados - Ecoturismo responsable, senderismo guiado y aventuras en la naturaleza. √önete a nuestra comunidad de aventureros.">
  <title>Somos Aventurados | Ecoturismo y Senderismo</title>
  <!-- Open Graph -->
  <meta property="og:title" content="SomosAventura2 - ¬°Vive la aventura con nosotros!">
  <meta property="og:description" content="Ecoturismo y Senderismo ‚ûï Rutas cada semana üîó S√© un aventurado üëáüèª">
  <meta property="og:image" content="https://somosaventura2.com/social-preview.jpg">
  <meta property="og:url" content="https://somosaventura2.com">
  <meta property="og:type" content="website">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="SomosAventura2 - ¬°Vive la aventura con nosotros!">
  <meta name="twitter:description" content="Ecoturismo y Senderismo ‚ûï Rutas cada semana üîó S√© un aventurado üëáüèª">
  <meta name="twitter:image" content="https://somosaventura2.com/social-preview.jpg">
  <meta name="twitter:url" content="https://somosaventura2.com">
  <link rel="icon" type="image/png" href="/favicon.png?v=99" sizes="32x32">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png?v=99">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2" defer></script>
  <style>
    :root {
      --whatsapp: #25D366;
      --green-primary: #4CAF50;
      --green-mountain: #2d5a3d;
      --green-dark: #1a3a28;
      --bg-dark: #0e2f36;
      --bg-card: #1a3d47;
      --text-primary: #ffffff;
      --text-secondary: #b8c5be;
      --accent: #76c893;
      --accent-orange: #ff8c42;
      --shadow: rgba(0, 0, 0, 0.5);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background: var(--bg-dark);
      color: var(--text-primary);
      line-height: 1.6;
      overflow-x: hidden;
    }

    body.lightbox-open {
      overflow: hidden;
    }

    .container {
      max-width: 480px;
      margin: 0 auto;
      background: linear-gradient(180deg, rgba(14, 47, 54, 0.95) 0%, rgba(18, 56, 64, 0.97) 100%),
                  url('fondo2.jpg') center/cover fixed;
      min-height: 100vh;
      position: relative;
    }

    .hero {
      background: linear-gradient(180deg, rgba(0, 0, 0, 0.6) 0%, rgba(10, 22, 18, 0.9) 100%), 
                  url('fondo.jpg') center/cover;
      text-align: center;
      padding: 60px 24px 50px;
      position: relative;
    }

    .hero::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 100px;
      background: linear-gradient(to bottom, transparent, var(--bg-dark));
    }

    .logo {
      width: 390px;
      max-width: 95%;
      margin-bottom: 20px;
      filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.6));
      position: relative;
      z-index: 2;
    }

    .hero h1 {
      font-size: clamp(28px, 8vw, 36px);
      font-weight: 800;
      line-height: 1.2;
      margin-bottom: 12px;
      position: relative;
      z-index: 2;
    }

    .hero h1 .highlight {
      color: var(--accent);
      display: block;
    }

    .hero p {
      font-size: 16px;
      color: var(--text-secondary);
      margin-bottom: 30px;
      position: relative;
      z-index: 2;
    }

    .hero-subcopy {
      display: block;
      margin: 8px auto 0;
      font-size: 0.75rem;
      line-height: 1.2;
      letter-spacing: -0.3px;
      color: rgba(255, 255, 255, 0.9);
      text-align: center;
      text-decoration: none;
      max-width: 280px;
      opacity: 0.9;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      width: calc(100% - 48px);
      max-width: 400px;
      padding: 18px 28px;
      background: linear-gradient(135deg, var(--green-primary) 0%, var(--green-mountain) 100%);
      color: var(--text-primary);
      font-weight: 700;
      font-size: 16px;
      text-decoration: none;
      border-radius: 50px;
      box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      z-index: 2;
      border: none;
      cursor: pointer;
      margin: 0 auto;
      overflow: hidden;
      animation: pulse-btn 2s infinite;
    }

    @keyframes pulse-btn {
      0%, 100% {
        box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
      }
      50% {
        box-shadow: 0 6px 30px rgba(76, 175, 80, 0.7);
      }
    }

    .btn::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -60%;
      width: 20%;
      height: 200%;
      background: rgba(255, 255, 255, 0.4);
      transform: rotate(30deg);
      animation: shine-effect 4s infinite;
    }

    @keyframes shine-effect {
      0% {
        left: -60%;
      }
      20% {
        left: 120%;
      }
      100% {
        left: 120%;
      }
    }

    .btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(76, 175, 80, 0.5);
    }

    .btn:active {
      transform: translateY(-1px);
    }

    .btn-secondary {
      background: linear-gradient(135deg, var(--green-mountain) 0%, var(--green-dark) 100%);
      box-shadow: 0 4px 15px rgba(45, 90, 61, 0.4);
    }

    .btn svg {
      width: 24px;
      height: 24px;
      flex-shrink: 0;
    }

    section {
      padding: 40px 24px;
    }

    .section-title {
      text-align: center;
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 28px;
      color: var(--accent);
      text-transform: uppercase;
      letter-spacing: 1px;
      position: relative;
      width: fit-content;
      margin-left: auto;
      margin-right: auto;
      padding-bottom: 10px;
    }

    .section-title::after {
      content: '';
      display: block;
      width: 100%;
      height: 3px;
      background: linear-gradient(90deg, transparent, #4CAF50, transparent);
      margin: 10px auto 0;
      border-radius: 2px;
    }

    .cards {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .card {
      background: var(--bg-card);
      border-radius: 16px;
      padding: 20px;
      display: flex;
      gap: 16px;
      align-items: flex-start;
      border: 1px solid rgba(118, 200, 147, 0.1);
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px var(--shadow);
    }

    .card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 24px rgba(118, 200, 147, 0.2);
      border-color: rgba(118, 200, 147, 0.3);
    }

    .card-icon {
      font-size: 32px;
      flex-shrink: 0;
      filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
    }

    .card-content h3 {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 6px;
      color: var(--text-primary);
    }

    .card-content p {
      font-size: 14px;
      color: var(--text-secondary);
      line-height: 1.5;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
      margin-top: 24px;
    }

    .stat-card {
      background: var(--bg-card);
      border-radius: 16px;
      padding: 20px 12px;
      text-align: center;
      border: 1px solid rgba(118, 200, 147, 0.1);
      transition: all 0.3s ease;
    }

    .stat-card:hover {
      transform: translateY(-4px);
      border-color: rgba(118, 200, 147, 0.3);
      box-shadow: 0 8px 24px rgba(118, 200, 147, 0.2);
    }

    .stat-number {
      font-size: 28px;
      font-weight: 800;
      color: var(--accent);
      display: block;
      margin-bottom: 4px;
    }

    .stat-label {
      font-size: 12px;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    /* ===== GALER√çA MOBILE-FIRST (480px container) ===== */
    .gallery-section {
      padding: 40px 24px;
    }

    .gallery-filters {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin-bottom: 20px;
    }

    .gallery-filter-btn {
      min-height: 44px;
      min-width: 44px;
      padding: 10px 18px;
      font-family: 'Poppins', sans-serif;
      font-size: 14px;
      font-weight: 600;
      color: var(--text-secondary);
      background: var(--bg-card);
      border: 1px solid rgba(118, 200, 147, 0.2);
      border-radius: 999px;
      cursor: pointer;
      transition: color 0.2s, background 0.2s, border-color 0.2s;
    }

    .gallery-filter-btn:hover {
      color: var(--accent);
      border-color: rgba(118, 200, 147, 0.4);
    }

    .gallery-filter-btn.active {
      color: var(--text-primary);
      background: rgba(118, 200, 147, 0.2);
      border-color: var(--accent);
    }

    .gallery-filter-btn:focus-visible {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }

    .gallery-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      margin: 0;
      list-style: none;
    }

    .gallery-item {
      margin: 0;
      position: relative;
      border-radius: 16px;
      overflow: hidden;
      aspect-ratio: 1;
      box-shadow: 0 4px 12px var(--shadow);
      transition: transform 0.25s ease, box-shadow 0.25s ease;
    }

    .gallery-item.gallery-item-hidden {
      display: none;
    }

    .gallery-item-trigger {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      padding: 0;
      margin: 0;
      border: none;
      background: none;
      cursor: pointer;
      display: block;
      -webkit-tap-highlight-color: transparent;
    }

    .gallery-item-trigger:focus {
      outline: none;
    }

    .gallery-item-trigger:focus-visible {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
      z-index: 2;
    }

    .gallery-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      vertical-align: middle;
    }

    .gallery-item-overlay {
      position: absolute;
      inset: 0;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      padding: 14px;
      background: linear-gradient(to top, rgba(0,0,0,0.85) 0%, rgba(0,0,0,0.4) 50%, transparent 100%);
      color: var(--text-primary);
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.25s ease, visibility 0.25s ease;
      pointer-events: none;
    }

    .gallery-item.is-overlay-visible .gallery-item-overlay,
    .gallery-item-trigger:hover .gallery-item-overlay,
    .gallery-item-trigger:focus .gallery-item-overlay,
    .gallery-item:hover .gallery-item-overlay {
      opacity: 1;
      visibility: visible;
    }

    .gallery-item-badge {
      display: inline-block;
      align-self: flex-start;
      padding: 4px 10px;
      font-size: 11px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      background: var(--accent);
      color: var(--bg-dark);
      border-radius: 6px;
      margin-bottom: 6px;
    }

    .gallery-item-title {
      font-size: 14px;
      font-weight: 700;
      line-height: 1.2;
    }

    .gallery-item-date {
      font-size: 12px;
      color: var(--text-secondary);
      margin-top: 2px;
    }

    .gallery-item:hover {
      transform: scale(1.02);
      box-shadow: 0 8px 24px rgba(118, 200, 147, 0.25);
      z-index: 5;
    }

    /* ===== RANKING TOP 10 AVENTURADOS ===== */
    .ranking-section {
      padding: 40px 24px;
    }

    .ranking-intro {
      text-align: center;
      color: var(--text-secondary);
      font-size: 14px;
      margin: -8px 0 24px;
    }

    .ranking-test-badge {
      display: inline-block;
      margin-left: 8px;
      padding: 2px 8px;
      font-size: 11px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      background: var(--accent-orange);
      color: var(--bg-dark);
      border-radius: 6px;
    }

    .ranking-container {
      min-height: 120px;
    }

    .ranking-loading {
      text-align: center;
      padding: 32px 16px;
      color: var(--text-secondary);
    }

    .ranking-loading::after {
      content: '‚õ∞Ô∏è';
      display: block;
      font-size: 40px;
      margin-top: 12px;
      animation: ranking-pulse 1.2s ease-in-out infinite;
    }

    @keyframes ranking-pulse {
      0%, 100% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.1); opacity: 0.8; }
    }

    .ranking-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    /* Podio: mobile-first = una columna (apilado); en pantallas anchas opcionalmente 3 columnas */
    .ranking-podio {
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
      margin-bottom: 20px;
      max-width: 100%;
    }

    .ranking-podio .ranking-card {
      margin-bottom: 0;
      position: relative;
      overflow: hidden;
    }

    /* Orden visual: 2¬∫, 1¬∫, 3¬∫ (1¬∫ en el centro al estar apilados) */
    .ranking-podio .ranking-card:nth-child(1) { order: 2; }
    .ranking-podio .ranking-card:nth-child(2) { order: 1; }
    .ranking-podio .ranking-card:nth-child(3) { order: 3; }

    .ranking-podio.ranking-podio--1 {
      grid-template-columns: 1fr;
      justify-items: stretch;
    }

    .ranking-podio.ranking-podio--1 .ranking-card {
      max-width: 280px;
      margin-left: auto;
      margin-right: auto;
    }

    .ranking-podio.ranking-podio--2 {
      grid-template-columns: 1fr;
    }

    /* Solo en pantallas anchas: podio de 2 en dos columnas; el de 3 siempre vertical */
    @media (min-width: 600px) {
      .ranking-podio.ranking-podio--2 {
        grid-template-columns: 1fr 1fr;
      }
    }

    /* Sin scroll a la secci√≥n: podio y rest ocultos, sin animaci√≥n */
    .ranking-section:not(.in-view) .ranking-podio .ranking-card {
      opacity: 0;
      animation: none;
    }

    .ranking-section:not(.in-view) .ranking-podio .ranking-card::before {
      animation: none;
    }

    .ranking-section:not(.in-view) .ranking-rest .ranking-card {
      opacity: 0;
      animation: none;
    }

    /* Al entrar en viewport (.in-view): se disparan las animaciones de entrada */
    .ranking-section.in-view .ranking-podio .ranking-card.rank-1 {
      background: linear-gradient(145deg, rgba(255, 215, 0, 0.22), var(--bg-card));
      border-color: rgba(255, 215, 0, 0.55);
      animation: podio-entrance-1 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) backwards, podio-glow-gold 2.8s ease-in-out 0.8s infinite;
    }

    /* Resplandor: misma duraci√≥n (3.2s), delays escalonados para secuencia 1¬∫ ‚Üí 2¬∫ ‚Üí 3¬∫ sin desincronizar */
    .ranking-section.in-view .ranking-podio .ranking-card.rank-1::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -80%;
      width: 28%;
      height: 200%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.45), transparent);
      transform: rotate(28deg);
      animation: podio-shine 3.2s ease-in-out 1.1s infinite;
      pointer-events: none;
    }

    .ranking-section.in-view .ranking-podio .ranking-card.rank-2 {
      background: linear-gradient(145deg, rgba(192, 192, 192, 0.18), var(--bg-card));
      border-color: rgba(192, 192, 192, 0.5);
      animation: podio-entrance-2 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94) backwards, podio-glow-silver 3.2s ease-in-out 0.6s infinite;
    }

    .ranking-section.in-view .ranking-podio .ranking-card.rank-2::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -80%;
      width: 22%;
      height: 200%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transform: rotate(25deg);
      animation: podio-shine 3.2s ease-in-out 1.68s infinite;
      pointer-events: none;
    }

    .ranking-section.in-view .ranking-podio .ranking-card.rank-3 {
      background: linear-gradient(145deg, rgba(205, 127, 50, 0.2), var(--bg-card));
      border-color: rgba(205, 127, 50, 0.5);
      animation: podio-entrance-3 0.5s ease-out backwards, podio-glow-bronze 3.8s ease-in-out 0.5s infinite;
    }

    .ranking-section.in-view .ranking-podio .ranking-card.rank-3::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -80%;
      width: 18%;
      height: 200%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.22), transparent);
      transform: rotate(22deg);
      animation: podio-shine 3.2s ease-in-out 2.26s infinite;
      pointer-events: none;
    }

    @keyframes podio-entrance-1 {
      0% {
        opacity: 0;
        transform: translateY(32px) scale(0.88);
        box-shadow: 0 0 0 rgba(255, 215, 0, 0);
      }
      50% {
        opacity: 1;
        transform: translateY(-4px) scale(1.02);
        box-shadow: 0 12px 40px rgba(255, 215, 0, 0.5), 0 0 60px rgba(255, 215, 0, 0.25);
      }
      100% {
        opacity: 1;
        transform: translateY(0) scale(1);
        box-shadow: 0 6px 24px rgba(255, 215, 0, 0.35), 0 0 30px rgba(255, 215, 0, 0.12);
      }
    }

    @keyframes podio-entrance-2 {
      0% {
        opacity: 0;
        transform: translateY(20px);
        box-shadow: 0 0 0 rgba(192, 192, 192, 0);
      }
      60% {
        opacity: 1;
        box-shadow: 0 8px 28px rgba(192, 192, 192, 0.3);
      }
      100% {
        opacity: 1;
        transform: translateY(0);
        box-shadow: 0 4px 18px rgba(192, 192, 192, 0.2);
      }
    }

    @keyframes podio-entrance-3 {
      0% {
        opacity: 0;
        transform: translateY(14px);
      }
      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes podio-shine {
      0% { left: -80%; }
      18% { left: 110%; }
      100% { left: 110%; }
    }

    @keyframes podio-glow-gold {
      0%, 100% { box-shadow: 0 6px 24px rgba(255, 215, 0, 0.35), 0 0 30px rgba(255, 215, 0, 0.1); }
      50% { box-shadow: 0 8px 32px rgba(255, 215, 0, 0.5), 0 0 50px rgba(255, 215, 0, 0.2); }
    }

    @keyframes podio-glow-silver {
      0%, 100% { box-shadow: 0 4px 18px rgba(192, 192, 192, 0.2); }
      50% { box-shadow: 0 6px 24px rgba(192, 192, 192, 0.35), 0 0 35px rgba(192, 192, 192, 0.08); }
    }

    @keyframes podio-glow-bronze {
      0%, 100% { box-shadow: 0 4px 16px rgba(205, 127, 50, 0.2); }
      50% { box-shadow: 0 5px 20px rgba(205, 127, 50, 0.3); }
    }

    .ranking-card {
      background: var(--bg-card);
      border-radius: 14px;
      padding: 14px 16px;
      display: flex;
      align-items: center;
      gap: 12px;
      border: 1px solid rgba(118, 200, 147, 0.15);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .ranking-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(118, 200, 147, 0.2);
    }

    .ranking-card .rank-num {
      flex-shrink: 0;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: rgba(118, 200, 147, 0.2);
      color: var(--accent);
      font-weight: 800;
      font-size: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .ranking-podio .ranking-card.rank-1 .rank-num { background: linear-gradient(135deg, #FFD700, #FFA500); color: #1a2e22; }
    .ranking-podio .ranking-card.rank-2 .rank-num { background: linear-gradient(135deg, #C0C0C0, #A0A0A0); color: #1a2e22; }
    .ranking-podio .ranking-card.rank-3 .rank-num { background: linear-gradient(135deg, #CD7F32, #8B4513); color: #fff; }

    .ranking-card .rank-emoji {
      font-size: 24px;
      line-height: 1;
    }

    .ranking-card .rank-body {
      flex: 1;
      min-width: 0;
    }

    .ranking-card .rank-name {
      font-weight: 700;
      font-size: 15px;
      color: var(--text-primary);
      margin-bottom: 2px;
    }

    .ranking-card .rank-meta {
      font-size: 12px;
      color: var(--text-secondary);
    }

    .ranking-card .rank-badge {
      flex-shrink: 0;
      padding: 4px 8px;
      border-radius: 8px;
      font-size: 11px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.3px;
    }

    .ranking-rest {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    /* Cards 4‚Äì10: compactas y con m√°s dise√±o */
    .ranking-rest .ranking-card {
      padding: 10px 14px 10px 12px;
      border-radius: 10px;
      gap: 10px;
      border: 1px solid rgba(118, 200, 147, 0.2);
      border-left: 3px solid var(--accent);
      background: linear-gradient(135deg, rgba(118, 200, 147, 0.06) 0%, var(--bg-card) 100%);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15), inset 0 1px 0 rgba(255, 255, 255, 0.03);
      position: relative;
      overflow: hidden;
    }

    .ranking-rest .ranking-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: linear-gradient(90deg, transparent, rgba(118, 200, 147, 0.25), transparent);
      opacity: 0.6;
    }

    .ranking-rest .ranking-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 14px rgba(118, 200, 147, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.04);
      border-left-color: var(--accent);
    }

    .ranking-rest .ranking-card .rank-num {
      width: 28px;
      height: 28px;
      font-size: 13px;
      border: 1px solid rgba(118, 200, 147, 0.3);
      box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1);
    }

    .ranking-rest .ranking-card .rank-emoji {
      font-size: 18px;
    }

    .ranking-rest .ranking-card .rank-name {
      font-size: 13px;
    }

    .ranking-rest .ranking-card .rank-meta {
      font-size: 11px;
    }

    .ranking-rest .ranking-card .rank-badge {
      padding: 3px 8px;
      font-size: 10px;
      border-radius: 6px;
      border: 1px solid rgba(118, 200, 147, 0.25);
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    }

    .ranking-section.in-view .ranking-list .ranking-card {
      animation: ranking-appear 0.4s ease-out backwards;
    }

    .ranking-podio .ranking-card:nth-child(1) { animation-delay: 0.08s; }
    .ranking-podio .ranking-card:nth-child(2) { animation-delay: 0.22s; }
    .ranking-podio .ranking-card:nth-child(3) { animation-delay: 0.15s; }

    .ranking-rest .ranking-card:nth-child(1) { animation-delay: 0.25s; }
    .ranking-rest .ranking-card:nth-child(2) { animation-delay: 0.3s; }
    .ranking-rest .ranking-card:nth-child(3) { animation-delay: 0.35s; }
    .ranking-rest .ranking-card:nth-child(4) { animation-delay: 0.4s; }
    .ranking-rest .ranking-card:nth-child(5) { animation-delay: 0.45s; }
    .ranking-rest .ranking-card:nth-child(6) { animation-delay: 0.5s; }
    .ranking-rest .ranking-card:nth-child(7) { animation-delay: 0.55s; }

    @keyframes ranking-appear {
      from {
        opacity: 0;
        transform: translateY(12px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .about-content {
      display: flex;
      flex-direction: column;
      gap: 24px;
      margin-top: 24px;
    }

    .about-image {
      width: 100%;
      border-radius: 20px;
      overflow: hidden;
      box-shadow: 0 8px 24px var(--shadow);
    }

    .about-image img {
      width: 100%;
      height: auto;
      display: block;
    }

    .about-text {
      background: var(--bg-card);
      border-radius: 16px;
      padding: 24px;
      border: 1px solid rgba(118, 200, 147, 0.1);
    }

    .about-text h3 {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 16px;
      color: var(--accent);
    }

    .about-text p {
      font-size: 15px;
      color: var(--text-secondary);
      line-height: 1.7;
      margin-bottom: 14px;
    }

    .about-text p:last-child {
      margin-bottom: 0;
    }

    .products-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 16px;
      margin-top: 24px;
    }

    .product-card {
      background: var(--bg-card);
      border-radius: 16px;
      overflow: hidden;
      border: 1px solid rgba(118, 200, 147, 0.1);
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px var(--shadow);
    }

    .product-card:hover {
      transform: translateY(-6px);
      box-shadow: 0 8px 24px rgba(118, 200, 147, 0.3);
      border-color: rgba(118, 200, 147, 0.3);
    }

    .product-image {
      width: 100%;
      height: 160px;
      object-fit: cover;
    }

    .product-info {
      padding: 16px;
    }

    .product-info h4 {
      font-size: 16px;
      font-weight: 700;
      margin-bottom: 4px;
      color: var(--text-primary);
    }

    .product-info p {
      font-size: 12px;
      color: var(--text-secondary);
    }

    .cta-section {
      text-align: center;
      padding: 50px 24px;
      background: linear-gradient(135deg, var(--green-mountain) 0%, var(--green-dark) 100%);
      border-radius: 24px;
      margin: 24px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
    }

    .cta-section h2 {
      font-size: 28px;
      margin-bottom: 16px;
      color: var(--accent);
    }

    .cta-section p {
      font-size: 16px;
      color: var(--text-secondary);
      margin-bottom: 30px;
    }

    footer {
      text-align: center;
      padding: 32px 24px;
      color: var(--text-secondary);
      font-size: 14px;
      border-top: 1px solid rgba(118, 200, 147, 0.1);
    }

    .social-links {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 20px;
      margin-top: 16px;
      padding-top: 16px;
    }

    .social-link {
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-primary);
      text-decoration: none;
      font-size: 14px;
      transition: all 0.3s ease;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: rgba(118, 200, 147, 0.1);
    }

    .social-link:hover {
      color: var(--accent);
      background: rgba(118, 200, 147, 0.2);
      transform: translateY(-2px);
    }

    .social-link svg {
      width: 24px;
      height: 24px;
    }

    /* ===== LIGHTBOX STYLES ===== */
    .lightbox {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      z-index: 9999;
      align-items: center;
      justify-content: center;
    }

    .lightbox.active {
      display: flex;
    }

    .lightbox-content {
      position: relative;
      max-width: 90%;
      max-height: 90%;
      animation: zoomIn 0.3s ease-out;
      overflow: hidden;
      touch-action: none;
    }

    @keyframes zoomIn {
      from {
        transform: scale(0.8);
        opacity: 0;
      }
      to {
        transform: scale(1);
        opacity: 1;
      }
    }

    .lightbox-slide {
      position: relative;
      width: 100%;
      height: 100%;
      transition: transform 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      will-change: transform;
    }

    .lightbox-slide.is-dragging {
      transition: none;
    }

    .lightbox-content img {
      display: block;
      max-width: 100%;
      max-height: 90vh;
      border-radius: 12px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8);
      pointer-events: none;
    }

    .lightbox-close {
      position: absolute;
      top: -50px;
      right: 0;
      background: rgba(255, 255, 255, 0.1);
      border: none;
      color: white;
      font-size: 36px;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      cursor: pointer;
      backdrop-filter: blur(10px);
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      line-height: 1;
    }

    .lightbox-close:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: rotate(90deg);
    }

    .lightbox-prev,
    .lightbox-next {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(255, 255, 255, 0.1);
      border: none;
      color: white;
      font-size: 32px;
      min-width: 48px;
      min-height: 48px;
      width: 48px;
      height: 48px;
      border-radius: 50%;
      cursor: pointer;
      backdrop-filter: blur(10px);
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .lightbox-prev {
      left: 20px;
    }

    .lightbox-next {
      right: 20px;
    }

    .lightbox-prev:hover,
    .lightbox-next:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: translateY(-50%) scale(1.1);
    }

    .lightbox-close:focus-visible,
    .lightbox-prev:focus-visible,
    .lightbox-next:focus-visible {
      outline: 2px solid var(--accent);
      outline-offset: 2px;
    }

    .lightbox-caption {
      position: absolute;
      bottom: calc(24px + env(safe-area-inset-bottom));
      left: 24px;
      right: 24px;
      text-align: center;
      color: var(--text-primary);
      font-size: 15px;
      font-weight: 600;
      padding: 10px 16px;
      background: rgba(0, 0, 0, 0.65);
      border-radius: 12px;
      backdrop-filter: blur(8px);
      opacity: 1;
      transition: opacity 0.3s ease;
      z-index: 10;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
      pointer-events: none;
    }

    .lightbox-caption:empty {
      display: none;
    }

    /* ===== SECCI√ìN RUTAS PR√ìXIMAS - MEJORADA ===== */
    #upcomingRoutes {
      display: none;
      padding: 50px 24px 40px;
      position: relative;
    }

    #upcomingRoutes.active {
      display: block;
      animation: fadeInSection 0.6s ease-out;
    }

    @keyframes fadeInSection {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Nota: Los t√≠tulos de secci√≥n usan el estilo global `.section-title` */

    .routes-grid {
      display: flex;
      flex-direction: column;
      gap: 20px;
      margin-top: 32px;
    }

    /* NUEVO DISE√ëO DE TARJETA (COVER CARD) */
    .route-card {
      position: relative;
      border-radius: 16px;
      overflow: hidden;
      border: 1px solid rgba(118, 200, 147, 0.15);
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      animation: slideInCard 0.5s ease-out;
      animation-fill-mode: both;
      background: transparent;
    }

    /* Parte superior: imagen de flyer */
    .route-image-header {
      position: relative;
      height: 200px;
      background-size: cover;
      background-position: center;
      border-radius: 16px 16px 0 0;
      overflow: hidden;
    }

    .route-image-header::after {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(to bottom, rgba(0, 0, 0, 0.35), rgba(0, 0, 0, 0.75));
    }

    /* Imagen seg√∫n d√≠a */
    .route-image-header.sabado {
      background-image: url('flyersab.jpg');
    }

    .route-image-header.domingo {
      background-image: url('flyerdom.jpg');
    }

    /* Badge de fecha dentro del header (esquina superior izquierda, fondo s√≥lido) */
    .route-date-badge {
      position: absolute;
      top: 14px;
      left: 14px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: #1a3d47; /* fondo s√≥lido para m√°xima legibilidad */
      color: #ffffff;
      padding: 6px 12px;
      border-radius: 999px;
      font-size: 13px;
      font-weight: 600;
      z-index: 2;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
    }

    .route-card:nth-child(1) {
      animation-delay: 0.1s;
    }

    .route-card:nth-child(2) {
      animation-delay: 0.2s;
    }

    @keyframes slideInCard {
      from {
        opacity: 0;
        transform: translateX(-30px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .route-card:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: 0 16px 40px rgba(118, 200, 147, 0.3);
      border-color: rgba(118, 200, 147, 0.4);
    }

    /* Indicador visual de d√≠a (S√°bado/Domingo) */
    .route-day-indicator {
      position: absolute;
      top: 16px;
      right: 16px;
      background: linear-gradient(135deg, var(--accent-orange), #ff6b35);
      color: white;
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 1px;
      box-shadow: 0 4px 12px rgba(255, 140, 66, 0.5);
      z-index: 10;
    }

    /* Parte inferior: cuerpo de la tarjeta */
    .route-card-inner {
      padding: 20px 20px 18px;
      position: relative;
      z-index: 1;
      background: #132F35;
      border-radius: 0 0 16px 16px;
    }

    .route-header {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-bottom: 16px;
    }

    .route-title {
      font-size: 20px;
      font-weight: 800;
      color: var(--text-primary);
      line-height: 1.3;
    }

    .route-subdate {
      font-size: 0.9rem;
      color: #b8c5be;
      margin-top: 2px;
      margin-bottom: 8px;
    }

    .route-date-icon {
      font-size: 16px;
    }

    /* Contenedor de informaci√≥n en grid */
    .route-info-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin: 20px 0;
      padding: 16px;
      background: rgba(0, 0, 0, 0.2);
      border-radius: 12px;
      border: 1px solid rgba(118, 200, 147, 0.1);
    }

    .route-info-item {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .route-info-label {
      font-size: 11px;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-weight: 600;
    }

    .route-info-value {
      font-size: 15px;
      color: var(--text-primary);
      font-weight: 700;
    }

    /* Precio discreto + footer */
    .route-footer {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin-top: 12px;
    }

    .route-price-inline {
      font-size: 13px;
      color: var(--text-secondary);
      background: rgba(0, 0, 0, 0.25);
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(118, 200, 147, 0.3);
      white-space: nowrap;
    }

    /* Barra de progreso mejorada */
    .route-progress {
      margin-top: 4px;
      margin-bottom: 12px;
    }

    .route-progress-bar {
      height: 8px;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 10px;
      overflow: hidden;
      margin-bottom: 10px;
      border: 1px solid rgba(118, 200, 147, 0.1);
    }

    .route-progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--green-primary), var(--accent));
      border-radius: 10px;
      transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 0 10px rgba(118, 200, 147, 0.5);
      position: relative;
      overflow: hidden;
    }

    .route-progress-fill::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(90deg, 
        transparent, 
        rgba(255, 255, 255, 0.3), 
        transparent);
      animation: shimmer 2s infinite;
    }

    @keyframes shimmer {
      0% {
        transform: translateX(-100%);
      }
      100% {
        transform: translateX(100%);
      }
    }

    .route-availability {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      font-size: 13px;
      font-weight: 600;
      padding: 8px 12px;
      border-radius: 8px;
      text-align: center;
    }

    .route-availability.normal {
      background: rgba(118, 200, 147, 0.15);
      color: var(--accent);
      border: 1px solid rgba(118, 200, 147, 0.3);
    }

    .route-availability.low {
      background: rgba(255, 193, 7, 0.15);
      color: #ffc107;
      border: 1px solid rgba(255, 193, 7, 0.3);
      animation: pulse-warning 2s infinite;
    }

    @keyframes pulse-warning {
      0%, 100% {
        box-shadow: 0 0 0 rgba(255, 193, 7, 0);
      }
      50% {
        box-shadow: 0 0 15px rgba(255, 193, 7, 0.4);
      }
    }

    .route-availability.low::before {
      content: 'üî•';
      font-size: 16px;
    }

    .route-availability.critical {
      background: rgba(244, 67, 54, 0.15);
      color: #f44336;
      border: 1px solid rgba(244, 67, 54, 0.3);
    }

    .route-availability.critical::before {
      content: '‚õî';
      font-size: 16px;
    }

    /* Bot√≥n de reserva mejorado */
    .route-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      width: 100%;
      padding: 16px;
      background: linear-gradient(135deg, var(--green-primary), var(--green-mountain));
      color: white;
      font-weight: 700;
      font-size: 15px;
      text-decoration: none;
      border-radius: 12px;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 4px 16px rgba(76, 175, 80, 0.4);
      position: relative;
      overflow: hidden;
    }

    .route-btn::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.2);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }

    .route-btn:hover::before {
      width: 300px;
      height: 300px;
    }

    .route-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(76, 175, 80, 0.6);
    }

    .route-btn:active {
      transform: translateY(0);
    }

    .route-btn svg {
      width: 20px;
      height: 20px;
      position: relative;
      z-index: 2;
    }

    .route-btn span {
      position: relative;
      z-index: 2;
    }

    /* Definici√≥n de la animaci√≥n suave */
    @keyframes glow-pulse-sutil {
      0% {
        /* Sombra base inicial (la que ya tiene, o similar) */
        box-shadow: 0 4px 12px rgba(37, 211, 102, 0.3);
      }
      50% {
        /* Expansi√≥n sutil del brillo (un poco m√°s lejos, un poco m√°s opaco) */
        box-shadow: 0 8px 20px rgba(37, 211, 102, 0.5);
      }
      100% {
        /* Vuelta al estado inicial */
        box-shadow: 0 4px 12px rgba(37, 211, 102, 0.3);
      }
    }

    /* Aplicar la animaci√≥n a la nueva clase */
    .btn-glow-sutil {
      /* 2.5 segundos para que sea lento y relajado */
      animation: glow-pulse-sutil 2.5s infinite ease-in-out;
      /* Asegurar transici√≥n suave para hover */
      transition: transform 0.2s, box-shadow 0.2s;
    }

    /* Opcional: Al pasar el mouse, fijar el brillo en su estado m√°ximo */
    .btn-glow-sutil:hover {
      animation: none; /* Pausa la animaci√≥n */
      box-shadow: 0 8px 25px rgba(37, 211, 102, 0.7); /* Brillo fuerte est√°tico */
      transform: translateY(-2px); /* Peque√±o levantamiento */
    }

    /* Responsive */
    @media (max-width: 400px) {
      .route-title {
        font-size: 20px;
      }
      
      .route-price {
        font-size: 32px;
      }

      .route-info-grid {
        grid-template-columns: 1fr;
      }
    }

    /* Loading state */
    .routes-loading {
      text-align: center;
      padding: 40px 20px;
      color: var(--text-secondary);
    }

    .routes-loading::after {
      content: '‚è≥';
      display: block;
      font-size: 48px;
      margin-top: 16px;
      animation: spin 2s linear infinite;
    }

    @keyframes spin {
      from {
        transform: rotate(0deg);
      }
      to {
        transform: rotate(360deg);
      }
    }

    /* Responsive adjustments */
    @media (max-width: 480px) {
      .hero {
        padding: 40px 20px 40px;
      }

      section {
        padding: 32px 20px;
      }

      .lightbox-prev,
      .lightbox-next {
        min-width: 48px;
        min-height: 48px;
        width: 48px;
        height: 48px;
        font-size: 28px;
      }

      .lightbox-prev {
        left: 12px;
      }

      .lightbox-next {
        right: 12px;
      }

      .lightbox-close {
        min-width: 48px;
        min-height: 48px;
        width: 48px;
        height: 48px;
        font-size: 28px;
        top: -48px;
      }
    }
    
    /* Bot√≥n flotante de WhatsApp */
    .whatsapp-fab {
      position: fixed;
      bottom: 24px;
      right: 24px;
      width: 64px;
      height: 64px;
      border-radius: 50%;
      background: #25D366;
      color: white;
      border: none;
      box-shadow: 0 8px 24px rgba(37, 211, 102, 0.5);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 32px;
      z-index: 1000;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      text-decoration: none;
      /* Safe area para iPhone */
      bottom: calc(24px + env(safe-area-inset-bottom));
      right: calc(24px + env(safe-area-inset-right));
    }
    
    .whatsapp-fab:hover {
      transform: scale(1.1) translateY(-4px);
      box-shadow: 0 12px 32px rgba(37, 211, 102, 0.6);
    }
    
    .whatsapp-fab:active {
      transform: scale(0.95);
    }
    
    @media (max-width: 480px) {
      .whatsapp-fab {
        width: 56px;
        height: 56px;
        font-size: 28px;
        bottom: calc(20px + env(safe-area-inset-bottom));
        right: calc(20px + env(safe-area-inset-right));
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Hero Section -->
    <div class="hero">
      <img src="logo.png" alt="Somos Aventurados Logo" class="logo" fetchpriority="high" width="390" height="auto">
      <h1>
        Vive la aventura
        <span class="highlight">con nosotros</span>
      </h1>
      <p>Ecoturismo ¬∑ Senderismo ¬∑ Comunidad</p>
      <a href="https://whatsapp.com/channel/0029Vb6vCSj4yltO4CJQJL2L" class="btn" target="_blank" rel="noopener">
        <svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
          <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/>
        </svg>
        S√© un Aventurado
      </a>
      <a href="https://whatsapp.com/channel/0029Vb6vCSj4yltO4CJQJL2L" class="hero-subcopy" target="_blank" rel="noopener">
        üì≤ √önete al canal y no te pierdas ninguna aventura
      </a>
    </div>

    <!-- About Section -->
    <section>
      <h2 class="section-title">¬øQui√©nes Somos?</h2>
      <div class="cards">
        <div class="card">
          <div class="card-icon">üå≤</div>
          <div class="card-content">
            <h3>Ecoturismo Responsable</h3>
            <p>Experiencias √∫nicas en la naturaleza, cuidando y respetando cada entorno que visitamos.</p>
          </div>
        </div>
        <div class="card">
          <div class="card-icon">ü•æ</div>
          <div class="card-content">
            <h3>Senderismo Guiado</h3>
            <p>Rutas dise√±adas para todos los niveles, desde principiantes hasta aventureros experimentados.</p>
          </div>
        </div>
        <div class="card">
          <div class="card-icon">üî•</div>
          <div class="card-content">
            <h3>Comunidad de Aventurados</h3>
            <p>√önete a m√°s de 800 aventurados que comparten la pasi√≥n por explorar la naturaleza.</p>
          </div>
        </div>
      </div>

      <div class="stats-grid">
        <div class="stat-card">
          <span class="stat-number">+800</span>
          <span class="stat-label">Aventurados</span>
        </div>
        <div class="stat-card">
          <span class="stat-number">+20</span>
          <span class="stat-label">Rutas</span>
        </div>
        <div class="stat-card">
          <span class="stat-number">2025</span>
          <span class="stat-label">Desde</span>
        </div>
      </div>
    </section>

    <!-- Secci√≥n Pr√≥ximas Aventuras -->
    <section id="upcomingRoutes">
      <h2 class="section-title">‚õ∞Ô∏è Pr√≥ximas Aventuras</h2>
      <div id="routesGrid" class="routes-grid">
        <div class="routes-loading">Cargando pr√≥ximas rutas...</div>
      </div>
    </section>

    <!-- Gallery Section (mobile-first, overlay al tap, filtros, lightbox) -->
    <section id="gallerySection" class="gallery-section">
      <h2 class="section-title">Nuestras Aventuras</h2>
      <div class="gallery-filters" role="tablist" aria-label="Filtrar galer√≠a por categor√≠a">
        <button type="button" class="gallery-filter-btn active" data-filter="todas" role="tab" aria-selected="true">Todas</button>
        <button type="button" class="gallery-filter-btn" data-filter="cascada" role="tab" aria-selected="false">Cascadas</button>
        <button type="button" class="gallery-filter-btn" data-filter="ruta" role="tab" aria-selected="false">Rutas</button>
      </div>
      <div class="gallery-grid" role="list">
        <figure class="gallery-item" data-category="cascada" data-caption="Cascada Los Gavilanes" data-badge="Cascada" data-date="2024">
          <button type="button" class="gallery-item-trigger" aria-label="Ver Cascada Los Gavilanes, 2024">
            <img src="galeria1.jpg" alt="Cascada Los Gavilanes" loading="lazy" width="240" height="240" decoding="async">
            <span class="gallery-item-overlay">
              <span class="gallery-item-badge">Cascada</span>
              <span class="gallery-item-title">Los Gavilanes</span>
              <span class="gallery-item-date">2025</span>
            </span>
          </button>
        </figure>
        <figure class="gallery-item" data-category="ruta" data-caption="Nuestros aventurados" data-badge="Aventura" data-date="2024">
          <button type="button" class="gallery-item-trigger" aria-label="Ver Nuestros aventurados, 2024">
            <img src="galeria2.jpg" alt="Nuestros aventurados" loading="lazy" width="240" height="240" decoding="async">
            <span class="gallery-item-overlay">
              <span class="gallery-item-badge">Aventura</span>
              <span class="gallery-item-title">Nuestros aventurados</span>
              <span class="gallery-item-date">2026</span>
            </span>
          </button>
        </figure>
        <figure class="gallery-item" data-category="cascada" data-caption="Cascada Los Aguacates" data-badge="Cascada" data-date="2024">
          <button type="button" class="gallery-item-trigger" aria-label="Ver Cascada Los Aguacates, 2024">
            <img src="galeria3.jpg" alt="Cascada Los Aguacates" loading="lazy" width="240" height="240" decoding="async">
            <span class="gallery-item-overlay">
              <span class="gallery-item-badge">Cascada</span>
              <span class="gallery-item-title">Los Aguacates</span>
              <span class="gallery-item-date">2025</span>
            </span>
          </button>
        </figure>
        <figure class="gallery-item" data-category="cascada" data-caption="El chorrer√≥n de Chuao" data-badge="Cascada" data-date="2024">
          <button type="button" class="gallery-item-trigger" aria-label="Ver El chorrer√≥n de Chuao, 2024">
            <img src="galeria4.jpg" alt="El chorrer√≥n de Chuao" loading="lazy" width="240" height="240" decoding="async">
            <span class="gallery-item-overlay">
              <span class="gallery-item-badge">Cascada</span>
              <span class="gallery-item-title">Chorrer√≥n de Chuao</span>
              <span class="gallery-item-date">2025</span>
            </span>
          </button>
        </figure>
        <figure class="gallery-item" data-category="cascada" data-caption="Cascada la reina" data-badge="Cascada" data-date="2024">
          <button type="button" class="gallery-item-trigger" aria-label="Ver Cascada la reina, 2024">
            <img src="galeria5.jpg" alt="Cascada la reina" loading="lazy" width="240" height="240" decoding="async">
            <span class="gallery-item-overlay">
              <span class="gallery-item-badge">Cascada</span>
              <span class="gallery-item-title">La Reina</span>
              <span class="gallery-item-date">2025</span>
            </span>
          </button>
        </figure>
        <figure class="gallery-item" data-category="ruta" data-caption="Los Azules" data-badge="Ruta" data-date="2024">
          <button type="button" class="gallery-item-trigger" aria-label="Ver Los Azules, 2024">
            <img src="galeria6.jpg" alt="Los Azules" loading="lazy" width="240" height="240" decoding="async">
            <span class="gallery-item-overlay">
              <span class="gallery-item-badge">Ruta</span>
              <span class="gallery-item-title">Los Azules</span>
              <span class="gallery-item-date">2026</span>
            </span>
          </button>
        </figure>
      </div>
    </section>

    <!-- Top 10 Aventurados (ranking desde Supabase) -->
    <section id="rankingSection" class="ranking-section">
      <h2 class="section-title">üèÜ Top 10 Aventurados</h2>
      <p class="ranking-intro">Los que m√°s rutas han conquistado con nosotros</p>
      <div id="rankingContainer" class="ranking-container">
        <div class="ranking-loading" id="rankingLoading">Cargando ranking...</div>
        <div id="rankingList" class="ranking-list" aria-live="polite" style="display: none;"></div>
      </div>
    </section>

    <!-- Team Section -->
    <section>
      <h2 class="section-title">Nuestra Historia</h2>
      <div class="about-content">
        <div class="about-image">
          <img src="cl.jpg" alt="Chantal y Luisfer" loading="lazy" width="480" height="320">
        </div>
        <div class="about-text">
          <p>Somos Chantal y Luisfer, dos amantes de la naturaleza que decidimos compartir nuestra pasi√≥n por el ecoturismo y el senderismo con el mundo.</p>
          <p>Desde agosto de 2024, hemos guiado a cientos de aventurados a trav√©s de las rutas m√°s espectaculares, siempre con un enfoque en el respeto al medio ambiente y la conexi√≥n con la naturaleza.</p>
          <p>Cada aventura es una oportunidad para crear recuerdos inolvidables, conocer nuevos amigos y reconectar con lo que realmente importa.</p>
        </div>
      </div>
    </section>

    <!-- Products Section -->
    <section>
      <h2 class="section-title">Equ√≠pate para la Aventura</h2>
      <div class="products-grid">
        <div class="product-card">
          <img src="chaqueta.jpg" alt="Cortavientos personalizados" class="product-image" loading="lazy" width="240" height="160">
          <div class="product-info">
            <h4>Chaquetas Cortavientos</h4>
            <p>Dise√±os exclusivos</p>
          </div>
        </div>
        <div class="product-card">
          <img src="franela.jpg" alt="Franelas personalizadas" class="product-image" loading="lazy" width="240" height="160">
          <div class="product-info">
            <h4>Franelas Aventura</h4>
            <p>Dise√±os exclusivos</p>
          </div>
        </div>
      </div>
    </section>

    <!-- CTA Section -->
    <div class="cta-section">
      <h2>¬øListo para tu Pr√≥xima Aventura?</h2>
      <p>Cont√°ctanos por WhatsApp y descubre todas nuestras rutas disponibles</p>
      <a href="https://wa.me/584244656881" class="btn" target="_blank" rel="noopener">
        <svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
          <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/>
        </svg>
        Escr√≠benos Ahora
      </a>
    </div>

    <!-- Footer -->
    <footer>
      <p><strong>¬© 2026 SomosAventura2</strong></p>
      <p>Ecoturismo responsable y senderismo guiado</p>
      <div class="social-links">
        <a href="https://www.instagram.com/somosaventura2/" target="_blank" rel="noopener" class="social-link" aria-label="Instagram">
          <svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
          </svg>
        </a>
        <a href="https://www.tiktok.com/@aventura2clips" target="_blank" rel="noopener" class="social-link" aria-label="TikTok">
          <svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path d="M19.59 6.69a4.83 4.83 0 01-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 01-5.2 1.74 2.89 2.89 0 012.31-4.64 2.93 2.93 0 01.88.13V9.4a6.84 6.84 0 00-1-.05A6.33 6.33 0 005 20.1a6.34 6.34 0 0010.86-4.43v-7a8.16 8.16 0 004.77 1.52v-3.4a4.85 4.85 0 01-1-.1z"/>
          </svg>
        </a>
      </div>
    </footer>
  </div>

  <!-- Lightbox (touch-friendly, ARIA) -->
  <div class="lightbox" id="lightbox" role="dialog" aria-modal="true" aria-label="Vista ampliada de la imagen">
    <button class="lightbox-close" id="lightboxClose" aria-label="Cerrar vista ampliada">&times;</button>
    <button class="lightbox-prev" id="lightboxPrev" aria-label="Imagen anterior">‚Äπ</button>
    <button class="lightbox-next" id="lightboxNext" aria-label="Siguiente imagen">‚Ä∫</button>
    <div class="lightbox-content">
      <div class="lightbox-slide" id="lightboxSlide">
        <img id="lightboxImage" src="" alt="">
      </div>
    </div>
    <div class="lightbox-caption" id="lightboxCaption"></div>
  </div>

  <script>
    // =============================================
    // GALER√çA: Filtros + Overlay al tap + Lightbox
    // =============================================
    const lightbox = document.getElementById('lightbox');
    const lightboxSlide = document.getElementById('lightboxSlide');
    const lightboxImage = document.getElementById('lightboxImage');
    const lightboxCaption = document.getElementById('lightboxCaption');
    const lightboxClose = document.getElementById('lightboxClose');
    const lightboxPrev = document.getElementById('lightboxPrev');
    const lightboxNext = document.getElementById('lightboxNext');

    let images = [];
    let currentIndex = 0;
    const SWIPE_THRESHOLD = 60;
    const SWIPE_DURATION = 350;

    function getVisibleItems() {
      return Array.from(document.querySelectorAll('.gallery-item')).filter(
        el => !el.classList.contains('gallery-item-hidden')
      );
    }

    function buildImagesFromItems(items) {
      return items.map(item => {
        const img = item.querySelector('img');
        return {
          src: img ? img.src : '',
          alt: img ? img.alt : '',
          caption: item.getAttribute('data-caption') || ''
        };
      });
    }

    function syncImagesFromVisible() {
      const visible = getVisibleItems();
      images = buildImagesFromItems(visible);
    }

    function openLightbox(index) {
      syncImagesFromVisible();
      if (images.length === 0) return;
      currentIndex = typeof index === 'number' ? Math.max(0, Math.min(index, images.length - 1)) : 0;
      if (lightboxSlide) lightboxSlide.style.transform = '';
      lightbox.classList.add('active');
      document.body.classList.add('lightbox-open');
      lightbox.setAttribute('aria-hidden', 'false');
      updateLightbox(false);
    }

    function updateLightbox(animate) {
      if (!images.length) return;
      const currentImage = images[currentIndex];
      if (!animate && lightboxSlide) {
        lightboxSlide.style.transition = 'none';
        lightboxSlide.style.transform = '';
      }
      lightboxImage.src = currentImage.src;
      lightboxImage.alt = currentImage.alt;
      if (lightboxCaption) lightboxCaption.textContent = currentImage.caption || '';
      lightboxImage.onload = () => {
        if (lightboxCaption) {
          lightboxCaption.style.opacity = '1';
          lightboxCaption.style.display = 'block';
        }
        if (!animate && lightboxSlide) {
          lightboxSlide.offsetHeight;
          lightboxSlide.style.transition = '';
        }
      };
    }

    function closeLightbox() {
      lightbox.classList.remove('active');
      document.body.classList.remove('lightbox-open');
      lightbox.setAttribute('aria-hidden', 'true');
      if (lightboxSlide) {
        lightboxSlide.style.transition = '';
        lightboxSlide.style.transform = '';
        lightboxSlide.classList.remove('is-dragging');
      }
    }

    function changeImage(direction) {
      syncImagesFromVisible();
      if (images.length === 0 || !lightboxSlide) return;
      const nextIndex = (currentIndex + direction + images.length) % images.length;
      if (nextIndex === currentIndex) return;

      lightboxSlide.classList.remove('is-dragging');
      lightboxSlide.style.transition = `transform ${SWIPE_DURATION}ms cubic-bezier(0.25, 0.46, 0.45, 0.94)`;
      lightboxSlide.style.transform = direction === 1 ? 'translateX(-100%)' : 'translateX(100%)';

      const onEnd = () => {
        lightboxSlide.removeEventListener('transitionend', onEnd);
        currentIndex = nextIndex;
        updateLightbox(false);
        lightboxSlide.style.transition = 'none';
        lightboxSlide.style.transform = direction === 1 ? 'translateX(100%)' : 'translateX(-100%)';
        lightboxSlide.offsetHeight;
        lightboxSlide.style.transition = `transform ${SWIPE_DURATION}ms cubic-bezier(0.25, 0.46, 0.45, 0.94)`;
        lightboxSlide.style.transform = 'translateX(0)';
      };
      lightboxSlide.addEventListener('transitionend', onEnd);
    }

    // Filtros: integrar con lightbox (solo se navegan √≠tems visibles)
    document.querySelectorAll('.gallery-filter-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        const filter = btn.getAttribute('data-filter');
        document.querySelectorAll('.gallery-filter-btn').forEach(b => {
          b.classList.remove('active');
          b.setAttribute('aria-selected', 'false');
        });
        btn.classList.add('active');
        btn.setAttribute('aria-selected', 'true');

        document.querySelectorAll('.gallery-item').forEach(item => {
          const cat = (item.getAttribute('data-category') || '').toLowerCase();
          if (filter === 'todas' || cat === filter) {
            item.classList.remove('gallery-item-hidden');
          } else {
            item.classList.add('gallery-item-hidden');
          }
        });
        syncImagesFromVisible();
      });
    });

    // Tap: primer toque muestra overlay, segundo abre lightbox
    document.querySelectorAll('.gallery-item-trigger').forEach(trigger => {
      trigger.addEventListener('click', (e) => {
        const figure = trigger.closest('.gallery-item');
        if (!figure || figure.classList.contains('gallery-item-hidden')) return;
        const visible = getVisibleItems();
        const index = visible.indexOf(figure);
        if (figure.classList.contains('is-overlay-visible')) {
          e.preventDefault();
          openLightbox(index);
          figure.classList.remove('is-overlay-visible');
        } else {
          document.querySelectorAll('.gallery-item.is-overlay-visible').forEach(el => el.classList.remove('is-overlay-visible'));
          figure.classList.add('is-overlay-visible');
        }
      });
    });

    lightboxClose.addEventListener('click', closeLightbox);
    lightboxPrev.addEventListener('click', (e) => { e.stopPropagation(); changeImage(-1); });
    lightboxNext.addEventListener('click', (e) => { e.stopPropagation(); changeImage(1); });
    lightbox.addEventListener('click', (e) => { if (e.target === lightbox) closeLightbox(); });

    document.addEventListener('keydown', (e) => {
      if (!lightbox.classList.contains('active')) return;
      if (e.key === 'Escape') closeLightbox();
      else if (e.key === 'ArrowLeft') changeImage(-1);
      else if (e.key === 'ArrowRight') changeImage(1);
    });

    let touchStartX = 0;
    let touchEndX = 0;
    let isSwiping = false;

    lightbox.addEventListener('touchstart', (e) => {
      if (!lightboxSlide || images.length === 0) return;
      touchStartX = e.touches[0].screenX;
      isSwiping = true;
      lightboxSlide.classList.add('is-dragging');
      lightboxSlide.style.transition = 'none';
    }, { passive: true });

    lightbox.addEventListener('touchmove', (e) => {
      if (!isSwiping || !lightboxSlide) return;
      const deltaX = e.touches[0].screenX - touchStartX;
      lightboxSlide.style.transform = `translateX(${deltaX}px)`;
      e.preventDefault();
    }, { passive: false });

    lightbox.addEventListener('touchend', (e) => {
      if (!isSwiping || !lightboxSlide) return;
      touchEndX = e.changedTouches[0].screenX;
      const deltaX = touchEndX - touchStartX;
      isSwiping = false;
      lightboxSlide.classList.remove('is-dragging');
      lightboxSlide.style.transition = `transform ${SWIPE_DURATION}ms cubic-bezier(0.25, 0.46, 0.45, 0.94)`;

      if (deltaX < -SWIPE_THRESHOLD && images.length > 1) {
        lightboxSlide.style.transform = 'translateX(-100%)';
        const onEnd = () => {
          lightboxSlide.removeEventListener('transitionend', onEnd);
          currentIndex = (currentIndex + 1) % images.length;
          const next = images[currentIndex];
          lightboxImage.src = next.src;
          lightboxImage.alt = next.alt;
          if (lightboxCaption) lightboxCaption.textContent = next.caption || '';
          lightboxSlide.style.transition = 'none';
          lightboxSlide.style.transform = 'translateX(100%)';
          lightboxSlide.offsetHeight;
          lightboxSlide.style.transition = `transform ${SWIPE_DURATION}ms cubic-bezier(0.25, 0.46, 0.45, 0.94)`;
          lightboxSlide.style.transform = 'translateX(0)';
        };
        lightboxSlide.addEventListener('transitionend', onEnd);
      } else if (deltaX > SWIPE_THRESHOLD && images.length > 1) {
        lightboxSlide.style.transform = 'translateX(100%)';
        const onEnd = () => {
          lightboxSlide.removeEventListener('transitionend', onEnd);
          currentIndex = (currentIndex - 1 + images.length) % images.length;
          const next = images[currentIndex];
          lightboxImage.src = next.src;
          lightboxImage.alt = next.alt;
          if (lightboxCaption) lightboxCaption.textContent = next.caption || '';
          lightboxSlide.style.transition = 'none';
          lightboxSlide.style.transform = 'translateX(-100%)';
          lightboxSlide.offsetHeight;
          lightboxSlide.style.transition = `transform ${SWIPE_DURATION}ms cubic-bezier(0.25, 0.46, 0.45, 0.94)`;
          lightboxSlide.style.transform = 'translateX(0)';
        };
        lightboxSlide.addEventListener('transitionend', onEnd);
      } else {
        lightboxSlide.style.transform = 'translateX(0)';
      }
    }, { passive: true });

    syncImagesFromVisible();
    lightbox.setAttribute('aria-hidden', 'true');

    // =============================================
    // SECCI√ìN RUTAS PR√ìXIMAS (Supabase)
    // =============================================
    document.addEventListener('DOMContentLoaded', function() {
      console.log('Supabase listo, cargando rutas...');
      
      const SUPABASE_URL = 'https://dgubxitmqegounjyeciw.supabase.co';
      const SUPABASE_ANON_KEY = 'sb_publishable_EY4EoqiHn7om0Qf-HYpJZQ_HwDJXlan';
      
      let supabaseClient = null;
      let realtimeChannel = null;
      
      // Verificar que Supabase est√© disponible antes de inicializar
      if (typeof supabase === 'undefined') {
        console.error('Supabase no est√° disponible. Verifica que el script se haya cargado correctamente.');
        return;
      }
      
      // Inicializar Supabase
      try {
        supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        console.log('Cliente de Supabase inicializado correctamente');
      } catch (error) {
        console.error('Error inicializando Supabase:', error);
        return;
      }

      // Funci√≥n para formatear fecha corta (Ej: "S√°b, 15 Mar")
      function formatearFechaCorta(fechaISO) {
        // Parseamos la fecha como local para evitar problemas de zona horaria
        const partes = fechaISO.split('-');
        const fecha = new Date(partes[0], partes[1] - 1, partes[2]);
        const dias = ['Dom', 'Lun', 'Mar', 'Mi√©', 'Jue', 'Vie', 'S√°b'];
        const meses = ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'];
        
        return `${dias[fecha.getDay()]}, ${fecha.getDate()} ${meses[fecha.getMonth()]}`;
      }

      // B6: Calcular cupos reservados = SUMA de 'cantidad' en reservas (no conteo de participantes)
      async function calcularCuposOcupados(rutaId) {
        try {
          const { data, error } = await supabaseClient
            .from('reservas')
            .select('cantidad')
            .eq('ruta_id', rutaId);

          if (error) {
            console.error('Error sumando cupos de reservas:', error);
            return 0;
          }

          const totalReservados = (data || []).reduce((sum, r) => sum + (r.cantidad || 0), 0);
          return totalReservados;
        } catch (error) {
          console.error('Error en calcularCuposOcupados (Landing):', error);
          return 0;
        }
      }

      // Funci√≥n para renderizar una tarjeta de ruta - NUEVA
      function renderizarRuta(ruta, cuposOcupados) {
        const disponibles = ruta.cupos - cuposOcupados;
        const porcentajeOcupado = ruta.cupos > 0 ? (cuposOcupados / ruta.cupos) * 100 : 0;
        
        // Determinar clase de urgencia
        let claseUrgencia = 'normal';
        let mensajeUrgencia = `${disponibles} cupos disponibles`;
        
        if (disponibles <= 0) {
          claseUrgencia = 'critical';
          mensajeUrgencia = '¬°Agotado!';
        } else if (disponibles < 5) {
          claseUrgencia = 'low';
          mensajeUrgencia = `¬°Solo ${disponibles} cupos!`;
        }
        
        // Determinar si la ruta est√° agotada (sin cupos disponibles)
        const rutaAgotada = cuposOcupados >= ruta.cupos;

        // Determinar d√≠a de la semana y fecha legible (forzando hora al mediod√≠a para evitar problemas de zona horaria)
        const fechaObj = new Date(ruta.fecha + 'T12:00:00');
        const esSabado = fechaObj.getDay() === 6;
        const nombreDia = fechaObj.toLocaleDateString('es-ES', { weekday: 'long' }).toUpperCase();
        // Ej: "15 de marzo" -> "15 de Marzo"
        let fechaFormateada = fechaObj.toLocaleDateString('es-ES', { day: 'numeric', month: 'long' });
        fechaFormateada = fechaFormateada.charAt(0).toUpperCase() + fechaFormateada.slice(1);

        // Precio en euros
        const precioEuros = ruta.precio_euros || ruta.precio_euro || 0;
        const precioFormateado = precioEuros > 0 ? `${parseFloat(precioEuros).toFixed(0)}‚Ç¨` : 'N/A';

        // Mensaje para WhatsApp
        const mensajeWhatsApp = encodeURIComponent(`Hola, quiero ir a ${ruta.nombre}`);
        const urlWhatsApp = `https://wa.me/584244656881?text=${mensajeWhatsApp}`;

        // Determinar nivel/dificultad (puedes agregar esto a tu base de datos)
        const nivel = ruta.nivel || 'Moderado';

        const clasesDia = esSabado ? 'sabado' : 'domingo';

        // Seleccionar imagen de fondo: primero foto_url, luego fallback por d√≠a
        let imagenFondo;
        if (ruta.foto_url) {
          imagenFondo = ruta.foto_url;
        } else {
          imagenFondo = esSabado ? 'flyersab.jpg' : 'flyerdom.jpg';
        }

        return `
          <div class="route-card">
            <div class="route-image-header ${clasesDia}" style="background-image: url('${imagenFondo}');">
              <div class="route-day-indicator">${nombreDia}</div>
            </div>

            <div class="route-card-inner">
              <div class="route-header">
                <h3 class="route-title">${ruta.nombre}</h3>
                <div class="route-subdate">üìÖ ${fechaFormateada}</div>
              </div>

              <div class="route-info-grid">
                <div class="route-info-item">
                  <span class="route-info-label">Cupos totales</span>
                  <span class="route-info-value">${ruta.cupos} personas</span>
                </div>
                <div class="route-info-item">
                  <span class="route-info-label">Reservados</span>
                  <span class="route-info-value">${cuposOcupados} / ${ruta.cupos}</span>
                </div>
              </div>

              <div class="route-progress">
                <div class="route-progress-bar">
                  <div class="route-progress-fill" style="width: ${Math.min(porcentajeOcupado, 100)}%"></div>
                </div>
                <div class="route-availability ${claseUrgencia}">${mensajeUrgencia}</div>
              </div>

              <div style="margin-top: auto; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.1); display: flex; justify-content: space-between; align-items: center; gap: 15px;">
                <div style="display: flex; flex-direction: column; justify-content: center;">
                  <span style="font-size: 0.7rem; color: #b8c5be; text-transform: uppercase; letter-spacing: 0.5px; line-height: 1; display: block; margin-bottom: 4px;">Precio Ref</span>
                  <span style="font-size: 2.2rem; font-weight: 800; color: #ffffff; line-height: 1.1;">${precioFormateado}</span>
                </div>
                ${
                  rutaAgotada
                    ? `
                      <a
                        class="route-btn"
                        aria-disabled="true"
                        tabindex="-1"
                        style="flex: 1; max-width: 200px; background: #ccc; color: #555; padding: 10px 16px; border-radius: 12px; font-weight: 700; text-decoration: none; display: flex; align-items: center; justify-content: center; gap: 8px; box-shadow: none; white-space: nowrap; cursor: not-allowed; pointer-events: none;">
                        <svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg" style="width: 18px; height: 18px;">
                          <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/>
                        </svg>
                        <span>Reservar ahora</span>
                      </a>
                    `
                    : `
                      <a 
                        href="${urlWhatsApp}" 
                        class="route-btn btn-glow-sutil" 
                        target="_blank" 
                        rel="noopener"
                        style="flex: 1; max-width: 200px; background: #25D366; color: #0e2f36; padding: 10px 16px; border-radius: 12px; font-weight: 700; text-decoration: none; display: flex; align-items: center; justify-content: center; gap: 8px; box-shadow: 0 4px 15px rgba(37, 211, 102, 0.3); white-space: nowrap; transition: transform 0.2s;">
                        <svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg" style="width: 18px; height: 18px;">
                          <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/>
                        </svg>
                        <span>Reservar ahora</span>
                      </a>
                    `
                }
              </div>
            </div>
          </div>
        `;
      }

      // Funci√≥n principal para cargar y mostrar rutas
      async function cargarRutasProximas() {
        const seccionRutas = document.getElementById('upcomingRoutes');
        const gridRutas = document.getElementById('routesGrid');
        
        if (!seccionRutas || !gridRutas || !supabaseClient) {
          if (seccionRutas) seccionRutas.style.display = 'none';
          return;
        }

        try {
          console.log('Cargando rutas pr√≥ximas...');
          
          // Obtener fecha de hoy
          const hoy = new Date();
          hoy.setHours(0, 0, 0, 0);
          const hoyISO = hoy.toISOString().split('T')[0];

          // Consultar las 2 pr√≥ximas rutas activas
          // En Supabase, los errores se manejan a trav√©s de la variable 'error' de la desestructuraci√≥n
          const { data: rutas, error } = await supabaseClient
            .from('rutas')
            .select('*')
            .eq('archivada', false)
            .gte('fecha', hoyISO)
            .order('fecha', { ascending: true })
            .limit(2);

          // Verificar si hubo error en la consulta
          if (error) {
            console.error('Error al cargar rutas:', error);
            seccionRutas.style.display = 'none';
            return;
          }

          // Si no hay rutas, ocultar secci√≥n
          if (!rutas || rutas.length === 0) {
            console.log('No se encontraron rutas pr√≥ximas');
            seccionRutas.style.display = 'none';
            return;
          }

          console.log(`Se encontraron ${rutas.length} rutas pr√≥ximas`);

          // Calcular cupos ocupados para cada ruta
          const rutasConCupos = await Promise.all(
            rutas.map(async (ruta) => {
              const cuposOcupados = await calcularCuposOcupados(ruta.id);
              return { ...ruta, cuposOcupados };
            })
          );

          // Renderizar tarjetas
          gridRutas.innerHTML = rutasConCupos
            .map(ruta => renderizarRuta(ruta, ruta.cuposOcupados))
            .join('');

          // Mostrar secci√≥n con animaci√≥n
          seccionRutas.classList.add('active');
          seccionRutas.style.display = 'block';
          
          console.log('Rutas cargadas y renderizadas correctamente');

        } catch (error) {
          console.error('Error en cargarRutasProximas:', error);
          const seccionRutas = document.getElementById('upcomingRoutes');
          if (seccionRutas) seccionRutas.style.display = 'none';
        }
      }

      // Inicializar suscripci√≥n Realtime para mantener las rutas actualizadas
      function initRealtimeRutas() {
        if (!supabaseClient || realtimeChannel) return;

        try {
          realtimeChannel = supabaseClient
            .channel('cambios-reservas-rutas')
            .on(
              'postgres_changes',
              { event: '*', schema: 'public', table: 'reservas' },
              () => {
                console.log('üîÅ Cambio en reservas detectado, recargando pr√≥ximas rutas...');
                cargarRutasProximas();
              }
            )
            .on(
              'postgres_changes',
              { event: '*', schema: 'public', table: 'rutas' },
              () => {
                console.log('üîÅ Cambio en rutas detectado, recargando pr√≥ximas rutas...');
                cargarRutasProximas();
              }
            )
            .subscribe();
          
          console.log('Suscripci√≥n Realtime inicializada');
        } catch (error) {
          console.error('Error inicializando Realtime:', error);
        }
      }

      // Cargar rutas y activar Realtime
      cargarRutasProximas();
      initRealtimeRutas();

      // =============================================
      // RANKING TOP 10 AVENTURADOS (desde participantes)
      // =============================================
      function calcularRangoAventurado(rutasAsistidas) {
        if (rutasAsistidas < 2) return { nombre: 'Novato', emoji: 'üå±', color: '#22c55e' };
        if (rutasAsistidas <= 4) return { nombre: 'Bronce', emoji: 'ü•â', color: '#CD7F32' };
        if (rutasAsistidas <= 9) return { nombre: 'Plata', emoji: 'ü•à', color: '#C0C0C0' };
        if (rutasAsistidas <= 14) return { nombre: 'Oro', emoji: 'ü•á', color: '#FFD700' };
        if (rutasAsistidas <= 19) return { nombre: 'Platino', emoji: 'üíé', color: '#E5E4E2' };
        return { nombre: 'Diamante', emoji: '‚ú®', color: '#b9f2ff' };
      }

      function getRankingTestData() {
        return [
          { nombre: 'Mar√≠a Garc√≠a', rutasAsistidas: 22 },
          { nombre: 'Carlos Rodr√≠guez', rutasAsistidas: 18 },
          { nombre: 'Ana Mart√≠nez', rutasAsistidas: 15 },
          { nombre: 'Luis Fern√°ndez', rutasAsistidas: 12 },
          { nombre: 'Laura S√°nchez', rutasAsistidas: 9 },
          { nombre: 'Pedro L√≥pez', rutasAsistidas: 7 },
          { nombre: 'Sofia Hern√°ndez', rutasAsistidas: 5 },
          { nombre: 'Diego Ram√≠rez', rutasAsistidas: 4 },
          { nombre: 'Elena Torres', rutasAsistidas: 3 },
          { nombre: 'Javier Flores', rutasAsistidas: 2 }
        ].map(p => ({
          nombre: p.nombre,
          rutasAsistidas: p.rutasAsistidas,
          rango: calcularRangoAventurado(p.rutasAsistidas)
        }));
      }

      async function cargarRankingTop10() {
        const container = document.getElementById('rankingContainer');
        const loading = document.getElementById('rankingLoading');
        const list = document.getElementById('rankingList');
        if (!container || !loading || !list) return;

        const useTestRanking = new URLSearchParams(window.location.search).get('ranking') === 'test';

        try {
          let ranking;

          if (useTestRanking) {
            ranking = getRankingTestData();
          } else {
            const { data: participantes, error } = await supabaseClient
              .from('participantes')
              .select('nombre, ruta_id, asiste');

            if (error) {
              console.error('Error cargando ranking:', error);
              loading.textContent = 'No pudimos cargar el ranking.';
              return;
            }

            const raw = participantes || [];
            const personasMap = new Map();
            raw.forEach(p => {
              const nombre = (p.nombre || '').trim();
              if (!nombre) return;
              if (!personasMap.has(nombre)) {
                personasMap.set(nombre, { nombre: nombre, rutasSet: new Set() });
              }
              const persona = personasMap.get(nombre);
              if (p.asiste === true) {
                const claveRuta = p.ruta_id || p.ruta_id;
                if (claveRuta) persona.rutasSet.add(claveRuta);
              }
            });

            const ordenRangos = { 'Diamante': 6, 'Platino': 5, 'Oro': 4, 'Plata': 3, 'Bronce': 2, 'Novato': 1 };
            ranking = Array.from(personasMap.values())
              .map(persona => {
                const rutasAsistidas = persona.rutasSet.size;
                const rango = calcularRangoAventurado(rutasAsistidas);
                return {
                  nombre: persona.nombre,
                  rutasAsistidas: rutasAsistidas,
                  rango: rango
                };
              })
              .filter(p => p.rutasAsistidas >= 2)
              .sort((a, b) => {
                const pesoA = ordenRangos[a.rango.nombre] || 0;
                const pesoB = ordenRangos[b.rango.nombre] || 0;
                if (pesoB !== pesoA) return pesoB - pesoA;
                if (b.rutasAsistidas !== a.rutasAsistidas) return b.rutasAsistidas - a.rutasAsistidas;
                return (a.nombre || '').localeCompare(b.nombre || '', 'es');
              })
              .slice(0, 10);
          }

          loading.style.display = 'none';
          list.style.display = 'flex';

          if (useTestRanking) {
            const intro = document.querySelector('#rankingSection .ranking-intro');
            if (intro) intro.innerHTML = 'Los que m√°s rutas han conquistado con nosotros <span class="ranking-test-badge">Vista previa</span>';
          }

          if (ranking.length === 0) {
            list.innerHTML = '<p class="ranking-intro" style="margin:0">¬°S√© el primero en sumar rutas y aparecer aqu√≠! ü•æ</p>';
            return;
          }

          const top3 = ranking.slice(0, 3);
          const rest = ranking.slice(3);

          const renderCard = (entry, position) => {
            const r = entry.rango;
            const badgeStyle = r.color ? `background:${r.color}22;color:${r.color};border:1px solid ${r.color}44` : '';
            return `
              <div class="ranking-card rank-${position}" role="listitem">
                <span class="rank-num">${position}</span>
                <span class="rank-emoji" aria-hidden="true">${r.emoji}</span>
                <div class="rank-body">
                  <div class="rank-name">${escapeHtml(entry.nombre)}</div>
                  <div class="rank-meta">${entry.rutasAsistidas} ${entry.rutasAsistidas === 1 ? 'ruta' : 'rutas'}</div>
                </div>
                <span class="rank-badge" style="${badgeStyle}">${r.nombre}</span>
              </div>`;
          };

          function escapeHtml(s) {
            const div = document.createElement('div');
            div.textContent = s;
            return div.innerHTML;
          }

          // Orden de visualizaci√≥n del podio: 1 persona ‚Üí [1¬∫]; 2 ‚Üí [2¬∫, 1¬∫]; 3 ‚Üí [2¬∫, 1¬∫, 3¬∫]
          const displayIndices = top3.length === 1 ? [0] : top3.length === 2 ? [1, 0] : [1, 0, 2];
          const displayPositions = top3.length === 1 ? [1] : top3.length === 2 ? [2, 1] : [2, 1, 3];
          const podioCards = displayIndices.map((idx, i) => renderCard(top3[idx], displayPositions[i]));

          const podioClass = 'ranking-podio ranking-podio--' + top3.length;
          const podioHtml = `
            <div class="${podioClass}" aria-label="Podio top 3">
              ${podioCards.join('')}
            </div>`;
          const restHtml = rest.length > 0
            ? `<div class="ranking-rest">${rest.map((e, i) => renderCard(e, i + 4)).join('')}</div>`
            : '';

          list.innerHTML = podioHtml + restHtml;
        } catch (err) {
          console.error('Error ranking:', err);
          loading.textContent = 'No pudimos cargar el ranking.';
        }
      }

      cargarRankingTop10();

      /* Animaci√≥n de entrada al hacer scroll: se dispara con un poco de demora para poder verlas */
      (function() {
        var section = document.getElementById('rankingSection');
        if (!section) return;
        var delayMs = 380;
        var timeoutId = null;
        var observer = new IntersectionObserver(function(entries) {
          entries.forEach(function(entry) {
            if (entry.isIntersecting) {
              if (timeoutId) return;
              timeoutId = setTimeout(function() {
                section.classList.add('in-view');
                timeoutId = null;
              }, delayMs);
            }
          });
        }, { threshold: 0.12 });
        observer.observe(section);
      })();
    });
  </script>

  <!-- Bot√≥n flotante de WhatsApp -->
  <a href="https://wa.me/584244656881" class="whatsapp-fab" target="_blank" rel="noopener" aria-label="Contactar por WhatsApp">
    <svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg" style="width: 32px; height: 32px;">
      <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/>
    </svg>
  </a>
</body>
</html>